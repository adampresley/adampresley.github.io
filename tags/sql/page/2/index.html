<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Sql &middot; Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>

<div class="container clearfix">
    <main role="main" class="content">
        <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
        
        
            <article class="post">
    
<h1><a href="http://adampresley.com/post/a-prettier-query-to-json-for-coldfusion-using-groovy/" title="A Prettier Query to JSON for ColdFusion using Groovy">A Prettier Query to JSON for ColdFusion using Groovy</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2009.09.22">2009.09.22</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/groovy">groovy</a>, 
        
        <a href="http://adampresley.com/tags/coldfusion">coldfusion</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>
        
    

</span>
</footer>

    <p>ColdFusion 8 introduced the ability to serialize data structures, arrays, and queries to JSON notation, making building AJAX-enabled applications even easier. There are a couple of annoyances, however, that still persist, and simply drive me nuts. Take the following query as an example. SELECTs.state_id, s.stateName, s.stateAbbrevFROM states AS sORDER BY s.state When you use the serializeJson() method in ColdFusion, you get a JSON structure that looks something like this. {&quot;COLUMNS&quot;:[&quot;STATE_ID&quot;,&quot;STATENAME&quot;,&quot;STATEABBREV&quot;],&quot;DATA&quot;:[[52,&quot;Alabama&quot;,&quot;AL&quot;],[53,&quot;Alaska&quot;,&quot;AK&quot;],[54,&quot;Arizona&quot;,&quot;AZ&quot;]]} No, that isn&rsquo;t the entire US state list because I truncated it for demonstration purposes.&hellip;</p>
    <a href="http://adampresley.com/post/a-prettier-query-to-json-for-coldfusion-using-groovy/" title="A Prettier Query to JSON for ColdFusion using Groovy"> &raquo;</a>
</article>

        
            <article class="post">
    
<h1><a href="http://adampresley.com/post/writing-c-functions-for-sql-server-and-clr-integration/" title="Writing C# Functions for SQL Server and CLR Integration">Writing C# Functions for SQL Server and CLR Integration</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2009.09.15">2009.09.15</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>, 
        
        <a href="http://adampresley.com/tags/csharp">csharp</a>
        
    

</span>
</footer>

    <p>An interested problem was presented to me today where a database table in SQL Server 2005 (now moved to 2008) had a trigger attached to a table that would encrypt a credit card number on insert or update. The encryption routine used the sp_OACreate stored procedure to make use of an older Microsoft cryptography library called CAPICOM. With the move to SQL Server 2008, however, we also upgraded our OS to 64-bit Windows.&hellip;</p>
    <a href="http://adampresley.com/post/writing-c-functions-for-sql-server-and-clr-integration/" title="Writing C# Functions for SQL Server and CLR Integration"> &raquo;</a>
</article>

        
            <article class="post">
    
<h1><a href="http://adampresley.com/post/images-in-sql/" title="Images in SQL">Images in SQL</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2009.02.09">2009.02.09</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>, 
        
        <a href="http://adampresley.com/tags/csharp">csharp</a>
        
    

</span>
</footer>

    <p>So I was presented with a task today of extracting images that were stored in a Microsoft SQL Server 2000 database and save them as JPEG files. Here is a bit of code that will do this. In this code sample I am assuming domain authenticated SQL login. The table name here will be called Photos and the column names id, type, and photo. SqlConnection connection; SqlCommand command; SqlDataReader reader; string outputDirectory = &quot;C:\TestLocation&quot;; PictureBox pic = new PictureBox(); using (connection = new SqlConnection(&quot;data source=MyServer;initial catalog=Database;persist security info=True;packet size=4096;Trusted_Connection=True&quot;)) { connection.Open(); command = new SqlCommand(&quot;SELECT id, type, photo FROM Photos&quot;, connection); command.CommandType = CommandType.Text; command.CommandTimeout = 3000; reader = command.ExecuteReader(); while (reader.Read()) { try { byte[] rawBytes = (byte[]) reader[&quot;photo&quot;]; MemoryStream memStream = new MemoryStream(); memStream.Write(rawBytes, 0, rawBytes.Length); string filename = outputDirectory + &quot;\image-&quot; + reader[&quot;id&quot;].ToString() + &quot;-&quot; + reader[&quot;type&quot;].ToString() + &quot;.jpg&quot;; pic.Image = Image.FromStream(memStream); pic.Image.Save(filename, System.Drawing.Imaging.ImageFormat.Jpeg); memStream.Close(); } catch (Exception ex) { } } } This C# code will loop over a record set and save the images stored in the table as JPEG files.&hellip;</p>
    <a href="http://adampresley.com/post/images-in-sql/" title="Images in SQL"> &raquo;</a>
</article>

        
            <article class="post">
    
<h1><a href="http://adampresley.com/post/how-to-change-the-owner-of-a-sql-2005-table/" title="How to Change the Owner of a SQL 2005 Table">How to Change the Owner of a SQL 2005 Table</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2008.12.09">2008.12.09</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>
        
    

</span>
</footer>

    <p>It isn&rsquo;t often that I need such a thing, but occasionally I get asked by an engineer to change the owner of a database table in MS SQL 2005. This happens sometimes, though I cannot always remember how, but changing the owner of a table is pretty easy. Just execute the following script, making sure you are logged in as &ldquo;sa&rdquo;. exec sp_changeObjectOwner &#39;originalObjectOwnerAndName&#39;, &#39;newOwner&#39;; For example, if the object name is &ldquo;MyTable1&rdquo;, and is owned by &ldquo;DOMAIN1\User1&rdquo;, and you wish it to simply be &ldquo;dbo&rdquo;, then you would do the following: exec sp_changeObjectOwner &#39;DOMAIN1\User1.MyTable1&#39;, &#39;dbo&#39;; Pretty simple.&hellip;</p>
    <a href="http://adampresley.com/post/how-to-change-the-owner-of-a-sql-2005-table/" title="How to Change the Owner of a SQL 2005 Table"> &raquo;</a>
</article>

        
            <article class="post">
    
<h1><a href="http://adampresley.com/post/foray-into-java/" title="Foray into Java">Foray into Java</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2007.02.28">2007.02.28</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>, 
        
        <a href="http://adampresley.com/tags/java">java</a>
        
    

</span>
</footer>

    <p>So recently I&rsquo;ve decided to delve into the world of Java development, or, more specifically, desktop Java development. So far I am liking it. My first task was to write a small application that would accept two dates as input and spit out a tab-separated report of first and last journal entries in a system, broken down by each day. Turned out to be a good learning experience, and useful to my bosses.&hellip;</p>
    <a href="http://adampresley.com/post/foray-into-java/" title="Foray into Java"> &raquo;</a>
</article>

        
        <div class="pagination">
<nav>

    
	<a class="btn newer" href="/tags/sql/" title="">&laquo; </a>
	

	<p class="counter"> 2  2</p>


	

</nav>
</div>

    </main>

    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>
<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

