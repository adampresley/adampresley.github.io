<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/groovys-metaclass-enhancing-the-language/" title="Groovy&#39;s MetaClass - Enhancing the Language">Groovy&#39;s MetaClass - Enhancing the Language</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2010.11.01">2010.11.01</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/groovy">groovy</a>
        
    

</span>
</footer>

            <p>Here&rsquo;s a little tidbit I wanted to share which demonstrates one of the
coolest bits about Groovy. Similar to how one can use prototyping in
JavaScript to enhance existing objects Groovy allows us to modify
existing classes using the <strong>metaClass</strong> property. In the next
example I will demonstrate how I created a new method against the
<strong>String</strong> class to execute the contents of the string using the
javax scripting engine: in other words I execute Groovy code
dynamically. Let&rsquo;s take a look at the code first.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">package</span> <span style="color: #f8f8f2">com</span><span style="color: #f92672">.</span><span style="color: #a6e22e">adampresley</span>

<span style="color: #f92672">import</span> <span style="color: #f8f8f2">javax.script.ScriptContext</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">javax.script.ScriptEngine</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">javax.script.ScriptEngineManager</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">javax.script.ScriptEngineFactory</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">Base</span> <span style="color: #f92672">{</span>
   <span style="color: #f8f8f2">ScriptEngineManager</span> <span style="color: #f8f8f2">manager</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">null</span>
   <span style="color: #f8f8f2">ScriptEngine</span> <span style="color: #f8f8f2">engine</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">null</span>

   <span style="color: #66d9ef">public</span> <span style="color: #a6e22e">Base</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
      <span style="color: #f8f8f2">manager</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">ScriptEngineManager</span><span style="color: #f92672">()</span>
      <span style="color: #f8f8f2">engine</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">manager</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getEngineByName</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;groovy&quot;</span><span style="color: #f92672">)</span>

      <span style="color: #f8f8f2">String</span><span style="color: #f92672">.</span><span style="color: #a6e22e">metaClass</span><span style="color: #f92672">.</span><span style="color: #a6e22e">run</span> <span style="color: #f92672">=</span> <span style="color: #f92672">{</span> <span style="color: #f8f8f2">Map</span> <span style="color: #f8f8f2">bindings</span> <span style="color: #f92672">-&gt;</span>
         <span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">b</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">engine</span><span style="color: #f92672">.</span><span style="color: #a6e22e">createBindings</span><span style="color: #f92672">()</span>
         <span style="color: #f8f8f2">b</span><span style="color: #f92672">.</span><span style="color: #a6e22e">putAll</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">bindings</span><span style="color: #f92672">)</span>

         <span style="color: #f8f8f2">engine</span><span style="color: #f92672">.</span><span style="color: #a6e22e">setBindings</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">b</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">ScriptContext</span><span style="color: #f92672">.</span><span style="color: #a6e22e">ENGINE_SCOPE</span><span style="color: #f92672">)</span>
         <span style="color: #f8f8f2">engine</span><span style="color: #f92672">.</span><span style="color: #a6e22e">eval</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">delegate</span><span style="color: #f92672">)</span>
      <span style="color: #f92672">}</span>
   <span style="color: #f92672">}</span>
<span style="color: #f92672">}</span>
</pre></div>


<p>In our constructor you can see how we first instantiate the Groovy
script engine using the <em>javax.script.ScriptEngineManager</em> class. We
then, using the <strong>metaClass</strong> property, add a new method named
<strong>run</strong> that takes a single argument which takes a Map of parameters
to bind to the script engine. This allows us to execute the text in the
string as Groovy code, and pass in a Map of parameters that our script
can use. Let&rsquo;s look at a sample usage.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">source</span> <span style="color: #f92672">=</span> <span style="color: #f92672">[</span> <span style="color: #e6db74">&quot;adam&quot;</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;danable&quot;</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;dood&quot;</span> <span style="color: #f92672">]</span>
<span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">code</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;source.findAll { it.contains(&#39;da&#39;) }&quot;</span>

<span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">code</span><span style="color: #f92672">.</span><span style="color: #a6e22e">run</span><span style="color: #f92672">([</span> <span style="color: #f8f8f2">source:</span> <span style="color: #f8f8f2">source</span> <span style="color: #f92672">])</span>
<span style="color: #75715e">// assert [ &quot;adam&quot;, &quot;danable&quot; ] == result</span>
</pre></div>
</p>

<p>And that&rsquo;s just the surface. I barely understand how all this magic
works, but I know it has come in handy for me. Why? There are various
reasons you would want to dynamically execute code, including libraries
for other languages, DSLs from code in a database, etc&hellip; Happy coding!</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fgroovys-metaclass-enhancing-the-language%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Groovy%27s%20MetaClass%20-%20Enhancing%20the%20Language&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fgroovys-metaclass-enhancing-the-language%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fgroovys-metaclass-enhancing-the-language%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fgroovys-metaclass-enhancing-the-language%2f&title=Groovy%27s%20MetaClass%20-%20Enhancing%20the%20Language" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/groovys-metaclass-enhancing-the-language\/';
    var disqus_title = 'Groovy\x27s MetaClass - Enhancing the Language';
    var disqus_url = 'http:\/\/adampresley.com\/post\/groovys-metaclass-enhancing-the-language\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

