<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/get-query-column-list-in-order-with-coldfusion/" title="Get Query Column List In Order with ColdFusion">Get Query Column List In Order with ColdFusion</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2010.03.29">2010.03.29</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/coldfusion">coldfusion</a>
        
    

</span>
</footer>

            <p>Don&rsquo;t know if you&rsquo;ve ever noticed, but it has been a long time behavior
that ColdFusion will alphabetize the order of columns in a query result
set. If you are working with queries in a manner where order is
important, such as serializing them to a format in JSON not supported
natively by ColdFusion, this becomes quite a bother. Below is a simple
solution to handle working with the query and its columns in order they
were put into the SQL statement.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">metadata</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">qry.getMetaData</span><span style="color: #f8f8f2">()</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">rowIndex</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">index</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">cols</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #75715e">&lt;!---</span>
<span style="color: #75715e">    Get an array of column names in ORDER they</span>
<span style="color: #75715e">    were put into the SQL statement.</span>
<span style="color: #75715e">---&gt;</span>
<span style="color: #f8f8f2">&lt;cfloop</span> <span style="color: #f8f8f2">from</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;1&quot;</span> <span style="color: #f8f8f2">to</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#metadata.getColumnCount()#&quot;</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;index&quot;</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">cols[index]</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">metadata.getColumnName</span><span style="color: #f8f8f2">(index)</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;/cfloop&gt;</span>

<span style="color: #75715e">&lt;!---</span>
<span style="color: #75715e">    Now we can loop over the query in column order</span>
<span style="color: #75715e">---&gt;</span>
<span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">rows</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;cfloop</span> <span style="color: #f8f8f2">from</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;1&quot;</span> <span style="color: #f8f8f2">to</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#qry.recordCount#&quot;</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;rowIndex&quot;</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">column</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{}</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #f8f8f2">&lt;cfloop</span> <span style="color: #f8f8f2">from</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;1&quot;</span> <span style="color: #f8f8f2">to</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#arrayLen(cols)#&quot;</span> <span style="color: #f8f8f2">index</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;index&quot;</span><span style="color: #f8f8f2">&gt;</span>
        <span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #f8f8f2">column[</span><span style="color: #e6db74">&quot;#cols[index]#&quot;</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">qry[</span><span style="color: #e6db74">&quot;#cols[index]#&quot;</span><span style="color: #f8f8f2">][rowIndex]</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #f8f8f2">&lt;/cfloop&gt;</span>

    <span style="color: #75715e">&lt;!---</span>
<span style="color: #75715e">        Now do something with this new row of data.</span>
<span style="color: #75715e">        In this example we are simply making an</span>
<span style="color: #75715e">        array of structs. You could do something fancier.</span>
<span style="color: #75715e">    ---&gt;</span>
    <span style="color: #f8f8f2">&lt;cfset</span> <span style="color: #a6e22e">arrayAppend</span><span style="color: #f8f8f2">(rows,</span> <span style="color: #f8f8f2">column)</span> <span style="color: #f92672">/</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;/cfloop&gt;</span>
</pre></div>


<p>In the above example we aren&rsquo;t transforming the data into anything more
fancy than an array of structures, but you could obviously turn the data
into any type of format you wished that could then be passed through
<em>serializeJson</em> to make JSON, or perhaps turned to XML. In any case,
if column order is important to you, this should help out.
Happy coding!</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fget-query-column-list-in-order-with-coldfusion%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Get%20Query%20Column%20List%20In%20Order%20with%20ColdFusion&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fget-query-column-list-in-order-with-coldfusion%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fget-query-column-list-in-order-with-coldfusion%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fget-query-column-list-in-order-with-coldfusion%2f&title=Get%20Query%20Column%20List%20In%20Order%20with%20ColdFusion" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/get-query-column-list-in-order-with-coldfusion\/';
    var disqus_title = 'Get Query Column List In Order with ColdFusion';
    var disqus_url = 'http:\/\/adampresley.com\/post\/get-query-column-list-in-order-with-coldfusion\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

