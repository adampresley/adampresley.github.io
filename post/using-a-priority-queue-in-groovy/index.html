<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/using-a-priority-queue-in-groovy/" title="Using a Priority Queue in Groovy">Using a Priority Queue in Groovy</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2010.11.08">2010.11.08</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/groovy">groovy</a>, 
        
        <a href="http://adampresley.com/tags/java">java</a>
        
    

</span>
</footer>

            <p>Although the title suggests something specific to Groovy the concept
demonstrated in this example will work in good old Java too, with a
couple of tweaks of course. In this blog entry we will look at what a
priority queue is, and how we can use Java to implement one.</p>

<p>Imagine we need to implement a ticket processing system where we need to
process ticket holder information. Further imagine that we need to
process these ticket holders in order of priority, and priority is
defined by the type of ticket that was purchased. For this demonstration
we will have the following ticket types and priorities, with a lower
priority number being a higher priority: Priority Club (1), Season
Ticket-holder (2), Online Purchase (3), and Ticket Booth (4). The first
thing to do is define an enumerator that provides these very definitions
we just laid out.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">package</span> <span style="color: #f8f8f2">com</span><span style="color: #f92672">.</span><span style="color: #a6e22e">adampresley</span><span style="color: #f92672">.</span><span style="color: #a6e22e">PriorityQueueExample</span>

<span style="color: #66d9ef">enum</span> <span style="color: #f8f8f2">TicketType</span> <span style="color: #f92672">{</span>
   <span style="color: #f8f8f2">TICKET_BOOTH</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Ticket Booth&quot;</span><span style="color: #f92672">,</span> <span style="color: #ae81ff">4</span><span style="color: #f92672">),</span>
   <span style="color: #f8f8f2">ONLINE</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Online Purchase&quot;</span><span style="color: #f92672">,</span> <span style="color: #ae81ff">3</span><span style="color: #f92672">),</span>
   <span style="color: #f8f8f2">SEASON_TICKETS</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Season Ticket-holder&quot;</span><span style="color: #f92672">,</span> <span style="color: #ae81ff">2</span><span style="color: #f92672">),</span>
   <span style="color: #f8f8f2">PRIORITY_CLUB</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Priority Club&quot;</span><span style="color: #f92672">,</span> <span style="color: #ae81ff">1</span><span style="color: #f92672">)</span>

   <span style="color: #66d9ef">private</span> <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">String</span> <span style="color: #f8f8f2">value</span>
   <span style="color: #66d9ef">private</span> <span style="color: #66d9ef">final</span> <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">priority</span>
   <span style="color: #66d9ef">public</span> <span style="color: #a6e22e">TicketType</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">value</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">priority</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
      <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">value</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">value</span>
      <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">priority</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">priority</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toInteger</span><span style="color: #f92672">()</span>
   <span style="color: #f92672">}</span>

   <span style="color: #66d9ef">public</span> <span style="color: #f8f8f2">String</span> <span style="color: #a6e22e">toString</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
      <span style="color: #f8f8f2">value</span>
   <span style="color: #f92672">}</span>

   <span style="color: #66d9ef">public</span> <span style="color: #66d9ef">int</span> <span style="color: #a6e22e">getPriority</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
      <span style="color: #f8f8f2">priority</span>
   <span style="color: #f92672">}</span>
<span style="color: #f92672">}</span>
</pre></div>


<p>Now that we have an enumeration for ticket types we should probably
define a ticket holder. For this example a ticket holder will be really
simple, providing a name and the ticket type they hold. We will also
override the <strong>toString()</strong> method to ensure that when we print this
object to the console we see the &ldquo;pretty&rdquo; version. Here&rsquo;s that code.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">package</span> <span style="color: #f8f8f2">com</span><span style="color: #f92672">.</span><span style="color: #a6e22e">adampresley</span><span style="color: #f92672">.</span><span style="color: #a6e22e">PriorityQueueExample</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">TicketHolder</span> <span style="color: #f92672">{</span>
   <span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">name</span>
   <span style="color: #f8f8f2">TicketType</span> <span style="color: #f8f8f2">ticketType</span>

   <span style="color: #66d9ef">public</span> <span style="color: #a6e22e">TicketHolder</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
      <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">TICKET_BOOTH</span><span style="color: #f92672">)</span>
   <span style="color: #f92672">}</span>

   <span style="color: #66d9ef">public</span> <span style="color: #a6e22e">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">name</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">ticketType</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
      <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">name</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">name</span>
      <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">ticketType</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ticketType</span>
   <span style="color: #f92672">}</span>

   <span style="color: #a6e22e">@Override</span>
   <span style="color: #66d9ef">public</span> <span style="color: #f8f8f2">String</span> <span style="color: #a6e22e">toString</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
      <span style="color: #e6db74">&quot;${name} (${ticketType.toString()})&quot;</span>
   <span style="color: #f92672">}</span>
<span style="color: #f92672">}</span>
</pre></div>
</p>

<p>And once we have this guy defined let&rsquo;s put it to the test. The
<strong>java.util</strong> package offers a class called <strong>PriorityQueue</strong>
that offers a means to add items to a queue that are sorted by some
comparison. By default, if you do not provide a comparator, natural
sorting is used. In our case we will provide a comparator that will
first compare by priority. If the priority between two items is the same
we will then sort by name. In the final example we create this queue,
then add a bunch of ticket holders to it. The final block of code will
loop and call <strong>poll()</strong> until we have no more items. Each call to
<strong>poll()</strong> will give us the next item in the queue.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">package</span> <span style="color: #f8f8f2">com</span><span style="color: #f92672">.</span><span style="color: #a6e22e">adampresley</span><span style="color: #f92672">.</span><span style="color: #a6e22e">PriorityQueueExample</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">Main</span> <span style="color: #f92672">{</span>
   <span style="color: #66d9ef">static</span> <span style="color: #a6e22e">main</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">args</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Create a priority queue with a comparator to determine what has priority.</span>
<span style="color: #75715e">       * If the priority is the same, sort by name as a secondary sort.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">queue</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">PriorityQueue</span><span style="color: #f92672">(</span><span style="color: #ae81ff">25</span><span style="color: #f92672">,</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Comparator</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">ticketholder</span><span style="color: #f92672">&gt;()</span> <span style="color: #f92672">{</span>
         <span style="color: #66d9ef">public</span> <span style="color: #66d9ef">int</span> <span style="color: #a6e22e">compare</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">TicketHolder</span> <span style="color: #f8f8f2">holder1</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketHolder</span> <span style="color: #f8f8f2">holder2</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
            <span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">holder1</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getTicketType</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getPriority</span><span style="color: #f92672">()</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">holder2</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getTicketType</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getPriority</span><span style="color: #f92672">())</span>
               <span style="color: #f8f8f2">holder1</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getName</span><span style="color: #f92672">()</span> <span style="color: #f92672">&lt;=&gt;</span> <span style="color: #f8f8f2">holder2</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getName</span><span style="color: #f92672">()</span>
            <span style="color: #66d9ef">else</span>
               <span style="color: #f8f8f2">holder1</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getTicketType</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getPriority</span><span style="color: #f92672">()</span> <span style="color: #f92672">&lt;=&gt;</span> <span style="color: #f8f8f2">holder2</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getTicketType</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getPriority</span><span style="color: #f92672">()</span>
         <span style="color: #f92672">}</span>
      <span style="color: #f92672">})</span>

      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Add a couple of regular buyers who bought tickets from</span>
<span style="color: #75715e">       * the ticket booth.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Ben Nadel&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">TICKET_BOOTH</span><span style="color: #f92672">))</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Ray Camdem&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">TICKET_BOOTH</span><span style="color: #f92672">))</span>

      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Now add somebody who bough a ticket online. This person gets</span>
<span style="color: #75715e">       * ahead in line before the other two.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Maryanne Anello&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">ONLINE</span><span style="color: #f92672">))</span>

      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Add a &quot;Priority Club&quot; member. This takes precedence in line ahead</span>
<span style="color: #75715e">       * of all the other people.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Adam Presley&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">PRIORITY_CLUB</span><span style="color: #f92672">))</span>

      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Now add a season ticket holder, and another online buyer.</span>
<span style="color: #75715e">       * Season ticket holders go in line before online.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Cameron Duke&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">SEASON_TICKETS</span><span style="color: #f92672">))</span>
      <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TicketHolder</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Jesse Roach&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">TicketType</span><span style="color: #f92672">.</span><span style="color: #a6e22e">ONLINE</span><span style="color: #f92672">))</span>


      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Display our queue as it currently stands.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #66d9ef">def</span> <span style="color: #f8f8f2">item</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">null</span>

      <span style="color: #66d9ef">while</span> <span style="color: #f92672">((</span><span style="color: #f8f8f2">item</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">queue</span><span style="color: #f92672">.</span><span style="color: #a6e22e">poll</span><span style="color: #f92672">())</span> <span style="color: #f92672">!=</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
         <span style="color: #f8f8f2">println</span> <span style="color: #f8f8f2">item</span>
      <span style="color: #f92672">}</span>
   <span style="color: #f92672">}</span>
<span style="color: #f92672">}</span>
</pre></div>
</p>

<p>You will notice when you run this example that the items are <strong>not</strong>
in the order we inserted them, but instead are in order of priority.
Pretty cool eh? Happy coding!!</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fusing-a-priority-queue-in-groovy%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Using%20a%20Priority%20Queue%20in%20Groovy&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fusing-a-priority-queue-in-groovy%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fusing-a-priority-queue-in-groovy%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fusing-a-priority-queue-in-groovy%2f&title=Using%20a%20Priority%20Queue%20in%20Groovy" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/using-a-priority-queue-in-groovy\/';
    var disqus_title = 'Using a Priority Queue in Groovy';
    var disqus_url = 'http:\/\/adampresley.com\/post\/using-a-priority-queue-in-groovy\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

