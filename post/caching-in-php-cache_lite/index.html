<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/caching-in-php-cache_lite/" title="&#39;Caching in PHP: Cache_Lite&#39;">&#39;Caching in PHP: Cache_Lite&#39;</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2007.05.30">2007.05.30</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/php">php</a>
        
    

</span>
</footer>

            <p>For many web application developers the concept of caching is foreign.
Most of us build our pages, query our databases, and spit out the
results. This is usually sufficient as the content is entirely dynamic.
There are times, however, when the data, although not static, doesn&rsquo;t
change very frequently, and can benefit from caching.</p>

<p>Caching can come in many complex flavors, but in this blog I will talk
about a <strong>very simple</strong> caching mechanism accomplished by using the PEAR
library&rsquo;s Cache_Lite class. Cache_Lite allows you to cache some
specific piece of data, or page content, or whatever, and retrieve it
quickly for reuse.</p>

<p>As an example let us say you have a database table with all of your
customers and information about them. This table is not likely to change
<strong>TOO</strong> quickly, so perhaps a web page that allows you to search and
manage these customers would benefit from caching. Let us also say that
this table is named <em>customers</em>, and you have one on 2 different
database servers, because you have several clusters. Lets also assume
you have an XML file that is the <strong>master</strong> list of all customers across
all clusters.</p>

<p>If you are building a web page that can search for customer by providing
information in a search criteria, you would have to read the XML file,
and then go to the customer table for each cluster to find the
information you want. Well, perhaps there is a better way. In this
example I am using an imaginary XML file which would look like this:</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f92672">&lt;customer&gt;</span>
   <span style="color: #f92672">&lt;customername&gt;</span>customerA<span style="color: #f92672">&lt;/customerName&gt;</span>
   <span style="color: #f92672">&lt;server&gt;</span>DB100<span style="color: #f92672">&lt;/server&gt;</span>
   <span style="color: #f92672">&lt;active&gt;</span>1<span style="color: #f92672">&lt;/active&gt;</span>
<span style="color: #f92672">&lt;/customer&gt;</span>
</pre></div>


<p>With this information we can then go the customer table on the database
server that each customer is on to retrieve additional information.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #75715e">&lt;?php</span>

<span style="color: #66d9ef">require_once</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Cache/Lite.php&quot;</span><span style="color: #f8f8f2">);</span>

<span style="color: #f8f8f2">$cacheId</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;UniqueCacheId&quot;</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">$cacheXmlGroup</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;xmlGroup&quot;</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">$cacheCustomerGroup</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;customerGroup&quot;</span><span style="color: #f8f8f2">;</span>

<span style="color: #f8f8f2">$cacheOptions</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">array</span><span style="color: #f8f8f2">(</span>
   <span style="color: #e6db74">&quot;lifeTime&quot;</span> <span style="color: #f92672">=&gt;</span> <span style="color: #ae81ff">3600</span><span style="color: #f8f8f2">,</span>
   <span style="color: #e6db74">&quot;automaticSerialization&quot;</span> <span style="color: #f92672">=&gt;</span> <span style="color: #66d9ef">true</span>
<span style="color: #f8f8f2">);</span>

<span style="color: #f8f8f2">$cache</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Cache_Lite</span><span style="color: #f8f8f2">($cacheOptions);</span>

<span style="color: #75715e">//--------------------------------------------------------------</span>
<span style="color: #75715e">// Read the XML master customer file. If the data is already in the</span>
<span style="color: #75715e">// cache use that.</span>
<span style="color: #75715e">//--------------------------------------------------------------</span>
<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">($cacheData</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$cache</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">get</span><span style="color: #f8f8f2">($cacheId,</span> <span style="color: #f8f8f2">$cacheXmlGroup))</span>
   <span style="color: #f8f8f2">$xmlCustomerList</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$cacheData;</span>
<span style="color: #66d9ef">else</span> <span style="color: #f8f8f2">{</span>
   <span style="color: #f8f8f2">$xmlCustomerList</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">simplexml_load_file(</span><span style="color: #e6db74">&quot;customerXmlFile.xml&quot;</span><span style="color: #f8f8f2">);</span>
   <span style="color: #f8f8f2">$cache</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">save</span><span style="color: #f8f8f2">($xmlCustomerList,</span> <span style="color: #f8f8f2">$cacheId,</span> <span style="color: #f8f8f2">$cacheXmlGroup);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #75715e">//----------------------------------------------------------------------------</span>
<span style="color: #75715e">// Get the detail information from the database server/cluster this customer is on.</span>
<span style="color: #75715e">// Assume we are already connected to each cluster database, and get all the</span>
<span style="color: #75715e">// data. We&#39;ll pretend we have an array of mysql connections. If this data</span>
<span style="color: #75715e">// is already cached, use that.</span>
<span style="color: #75715e">//----------------------------------------------------------------------------</span>
<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">($cacheData</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$cache</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">get</span><span style="color: #f8f8f2">($cacheId,</span> <span style="color: #f8f8f2">$cacheCustomerGroup))</span>
   <span style="color: #f8f8f2">$customerArray</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$cacheData;</span>
<span style="color: #66d9ef">else</span> <span style="color: #f8f8f2">{</span>
   <span style="color: #66d9ef">foreach</span> <span style="color: #f8f8f2">($connectionArray</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">$connection)</span> <span style="color: #f8f8f2">{</span>
      <span style="color: #f8f8f2">$qry</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">mysql_query(</span><span style="color: #e6db74">&quot;SELECT * FROM customers&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">$connection);</span>

      <span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">($row</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">mysql_fetch_object($qry))</span> <span style="color: #f8f8f2">{</span>
         <span style="color: #f8f8f2">$customerArray[$row</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">customerName</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;additionalInfo1&quot;</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$row</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">additionalInfo1</span><span style="color: #f8f8f2">;</span>
         <span style="color: #f8f8f2">$customerArray[$row</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">customerName</span><span style="color: #f8f8f2">][</span><span style="color: #e6db74">&quot;additionalInfo2&quot;</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">$row</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">additionalInfo2</span><span style="color: #f8f8f2">;</span>
      <span style="color: #f8f8f2">}</span>
   <span style="color: #f8f8f2">}</span>

   <span style="color: #f8f8f2">$cache</span><span style="color: #f92672">-&gt;</span><span style="color: #a6e22e">save</span><span style="color: #f8f8f2">($customerArray,</span> <span style="color: #f8f8f2">$cacheId,</span> <span style="color: #f8f8f2">$cacheCustomerGroup);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #75715e">?&gt;</span>
</pre></div>


<p>In this example we are loading two pieces of data. The first is an XML
file with a master customer list, containing all customers across
multiple clusters. Each cluster has a database server with a customer
table that has detailed information about customer on IT&rsquo;S cluster. With
this data retrieved you can then do just about anything with that data.
Search on it&hellip; Manipulate it&hellip; Data mining&hellip; whatever.</p>

<p>The COOL thing about this is the caching. While the cache file is still
valid the XML and customer information data is pulled from the cache
file instead of reading the XML and querying the database EACH time.
This is a significant speed boost.</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fcaching-in-php-cache_lite%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=%27Caching%20in%20PHP%3a%20Cache_Lite%27&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fcaching-in-php-cache_lite%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fcaching-in-php-cache_lite%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fcaching-in-php-cache_lite%2f&title=%27Caching%20in%20PHP%3a%20Cache_Lite%27" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/caching-in-php-cache_lite\/';
    var disqus_title = '\x27Caching in PHP: Cache_Lite\x27';
    var disqus_url = 'http:\/\/adampresley.com\/post\/caching-in-php-cache_lite\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

