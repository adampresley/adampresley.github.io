<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/experimenting-with-sql-to-json-in-sql-server-2008/" title="Experimenting with SQL to JSON in SQL Server 2008">Experimenting with SQL to JSON in SQL Server 2008</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2010.07.14">2010.07.14</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/sql">sql</a>, 
        
        <a href="http://adampresley.com/tags/csharp">csharp</a>
        
    

</span>
</footer>

            <p>In the last couple of days at work my friend Adrian (@iknowkungfoo) and
I (@adampresley) have been tossing around how we can improve performance
on various portions of the application we work on. On of the trouble
areas has always been large query sets that then have to be transformed
into JSON for an AJAX response.</p>

<p>One little feature introduced in SQL Server 2005 that I had completely
forgot about is the ability to take a given query result set and turn it
into XML. It&rsquo;s a very nifty feature, and once Adrian reminded me of this
some thoughts started to take shape. First let&rsquo;s look at how the XML
feature works. Below is a query that I ran against a test database that
contains address information. Below that is a screenshot of how the
result set looks using the XML feature.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">SELECT</span>
   <span style="color: #f8f8f2">id</span>
   <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">firstName</span>
   <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">lastName</span>
   <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">email</span>
   <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">phone</span>
   <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">postalCode</span>
<span style="color: #66d9ef">FROM</span> <span style="color: #f8f8f2">address</span>
<span style="color: #66d9ef">ORDER</span> <span style="color: #66d9ef">BY</span>
   <span style="color: #f8f8f2">firstName,</span> <span style="color: #f8f8f2">lastName</span>
<span style="color: #66d9ef">FOR</span> <span style="color: #f8f8f2">XML</span> <span style="color: #f8f8f2">AUTO,</span> <span style="color: #f8f8f2">ROOT(</span><span style="color: #e6db74">&#39;addresses&#39;</span><span style="color: #f8f8f2">)</span>
</pre></div>


<p>Ok, so that&rsquo;s pretty cool. So what I&rsquo;ve done so far is write a .NET
assembly that I register in SQL Server, wrap a SQL function around the
.NET method, and am using this to turn the XML from the query into JSON.
For more info on creating and registering a .NET method in SQL server
see my previous post <a href="http://blog.adampresley.com/2009/writing-csharp-functions-for-sql-server-and-clr-integration/">Writing C# Functions for SQL Server and CLR
Integration</a>.
So without any ado here is the code for the assembly.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Data;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Data.SqlTypes;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Data.SqlClient;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">Microsoft.SqlServer.Server;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Collections.Generic;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Linq;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Text;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.IO;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Xml;</span>
<span style="color: #66d9ef">using</span> <span style="color: #f8f8f2">System.Xml.XPath;</span>

<span style="color: #75715e">/**</span>
<span style="color: #75715e"> * The JSONTransformer class provides methods to encode XML datasets</span>
<span style="color: #75715e"> * into JSON. These methods are intended to be used by a</span>
<span style="color: #75715e"> * Microsoft SQL Server 2005 or higher.</span>
<span style="color: #75715e"> * @author Adam Presley</span>
<span style="color: #75715e"> */</span>
<span style="color: #66d9ef">public</span> <span style="color: #66d9ef">partial</span> <span style="color: #66d9ef">class</span> <span style="color: #a6e22e">JSONTransformer</span>
<span style="color: #f8f8f2">{</span>
   <span style="color: #75715e">/**</span>
<span style="color: #75715e">    * This method takes an XML dataset and serializes it to a</span>
<span style="color: #75715e">    * JSON string acceptable for AJAX/client use.</span>
<span style="color: #75715e">    *</span>
<span style="color: #75715e">    * &lt;code&gt;</span>
<span style="color: #75715e">    * DECLARE @resultSetXML VARCHAR(max);</span>
<span style="color: #75715e">    * DECLARE @rootNodeName VARCHAR(75);</span>
<span style="color: #75715e">    * DECLARE @elementNodeName VARCHAR(75);</span>
<span style="color: #75715e">    * DECLARE @result VARCHAR(max);</span>
<span style="color: #75715e">    *</span>
<span style="color: #75715e">    * SET @rootNodeName = &#39;addresses&#39;;</span>
<span style="color: #75715e">    * SET @elementNodeName = &#39;address&#39;;</span>
<span style="color: #75715e">    *</span>
<span style="color: #75715e">    * SET @resultSetXML = (</span>
<span style="color: #75715e">    *     SELECT</span>
<span style="color: #75715e">    *         id</span>
<span style="color: #75715e">    *         , firstName</span>
<span style="color: #75715e">    *         , lastName</span>
<span style="color: #75715e">    *         , email</span>
<span style="color: #75715e">    *         , phone</span>
<span style="color: #75715e">    *         , postalCode</span>
<span style="color: #75715e">    * FROM address</span>
<span style="color: #75715e">    *     ORDER BY</span>
<span style="color: #75715e">    *         firstName, lastName</span>
<span style="color: #75715e">    * FOR XML AUTO, ROOT(&#39;addresses&#39;));</span>
<span style="color: #75715e">    *</span>
<span style="color: #75715e">    * SELECT dbo.SQLJsonEncode(@resultSetXML, @rootNodeName, @elementNodeName) AS jsonResult;</span>
<span style="color: #75715e">    * &lt;/code&gt;</span>
<span style="color: #75715e">    *</span>
<span style="color: #75715e">    * @author Adam Presley</span>
<span style="color: #75715e">    * @param resultSetXML - The SQL result set serialized to XML</span>
<span style="color: #75715e">    * @param rootNodeName - The name of the XML root node</span>
<span style="color: #75715e">    * @param elementNodeName - The name of a record&#39;s XML node</span>
<span style="color: #75715e">    * @returns A string containing the resultset as JSON.</span>
<span style="color: #75715e">    */</span>
<span style="color: #a6e22e">   [SqlFunction()]</span>
   <span style="color: #66d9ef">public</span> <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">string</span> <span style="color: #a6e22e">Encode</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">resultSetXML,</span> <span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">rootNodeName,</span> <span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">elementNodeName)</span> <span style="color: #f8f8f2">{</span>
      <span style="color: #f8f8f2">XmlDocument</span> <span style="color: #f8f8f2">xmlDoc</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">XmlDocument();</span>
      <span style="color: #f8f8f2">DataSet</span> <span style="color: #f8f8f2">dataset</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">DataSet();</span>
      <span style="color: #f8f8f2">StringBuilder</span> <span style="color: #f8f8f2">result</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">StringBuilder();</span>
      <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">recordCount</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
      <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">currentIndex</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>

      <span style="color: #75715e">/*</span>
<span style="color: #75715e">       * Create an XPath iterator.</span>
<span style="color: #75715e">       */</span>
      <span style="color: #f8f8f2">XmlTextReader</span> <span style="color: #f8f8f2">reader</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">XmlTextReader(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">StringReader(resultSetXML));</span>
      <span style="color: #f8f8f2">XPathDocument</span> <span style="color: #f8f8f2">xdoc</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">XPathDocument(reader);</span>
      <span style="color: #f8f8f2">XPathNavigator</span> <span style="color: #f8f8f2">nav</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">xdoc.CreateNavigator();</span>
      <span style="color: #f8f8f2">XPathNodeIterator</span> <span style="color: #f8f8f2">iter</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">nav.Select(rootNodeName</span> <span style="color: #f8f8f2">+</span> <span style="color: #e6db74">&quot;/&quot;</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">elementNodeName);</span>

      <span style="color: #f8f8f2">recordCount</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">iter.Count;</span>
      <span style="color: #f8f8f2">currentIndex</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>

      <span style="color: #f8f8f2">result.Append(</span><span style="color: #e6db74">&quot;{ \&quot;recordcount\&quot;: \&quot;&quot;</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">recordCount.ToString()</span> <span style="color: #f8f8f2">+</span> <span style="color: #e6db74">&quot;\&quot;, \&quot;data\&quot;: [ &quot;</span><span style="color: #f8f8f2">);</span>

      <span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">(iter.MoveNext())</span> <span style="color: #f8f8f2">{</span>
         <span style="color: #f8f8f2">XPathNavigator</span> <span style="color: #f8f8f2">item</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">iter.Current;</span>
         <span style="color: #f8f8f2">result.Append(</span><span style="color: #e6db74">&quot;{ &quot;</span><span style="color: #f8f8f2">);</span>

         <span style="color: #75715e">/*</span>
<span style="color: #75715e">          * If we have attributes iterate over them and add them to</span>
<span style="color: #75715e">          * the JSON object.</span>
<span style="color: #75715e">          */</span>
         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(item.HasAttributes)</span> <span style="color: #f8f8f2">{</span>
            <span style="color: #f8f8f2">item.MoveToFirstAttribute();</span>
            <span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">line</span> <span style="color: #f8f8f2">=</span> <span style="color: #e6db74">&quot;&quot;</span><span style="color: #f8f8f2">;</span>

            <span style="color: #66d9ef">do</span> <span style="color: #f8f8f2">{</span>
               <span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">name</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">item.Name;</span>
               <span style="color: #66d9ef">string</span> <span style="color: #66d9ef">value</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">item.Value;</span>

               <span style="color: #f8f8f2">line</span> <span style="color: #f8f8f2">+=</span> <span style="color: #e6db74">&quot;\&quot;&quot;</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">name</span> <span style="color: #f8f8f2">+</span> <span style="color: #e6db74">&quot;\&quot;: \&quot;&quot;</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">__jsonEscape(</span><span style="color: #66d9ef">value</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">+</span> <span style="color: #e6db74">&quot;\&quot;, &quot;</span><span style="color: #f8f8f2">;</span>
            <span style="color: #f8f8f2">}</span> <span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">(item.MoveToNextAttribute());</span>

            <span style="color: #75715e">/*</span>
<span style="color: #75715e">             * Remove trailing comma</span>
<span style="color: #75715e">             */</span>
            <span style="color: #f8f8f2">line</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">line.Substring(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">line.Length</span> <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">2</span><span style="color: #f8f8f2">);</span>
            <span style="color: #f8f8f2">result.Append(line);</span>
         <span style="color: #f8f8f2">}</span>

         <span style="color: #f8f8f2">result.Append(</span><span style="color: #e6db74">&quot; }&quot;</span><span style="color: #f8f8f2">);</span>
         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(currentIndex</span> <span style="color: #f8f8f2">&lt;</span> <span style="color: #f8f8f2">recordCount</span> <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">result.Append(</span><span style="color: #e6db74">&quot;, &quot;</span><span style="color: #f8f8f2">);</span>
         <span style="color: #f8f8f2">currentIndex++;</span>
      <span style="color: #f8f8f2">}</span>

      <span style="color: #f8f8f2">result.Append(</span><span style="color: #e6db74">&quot; ]}&quot;</span><span style="color: #f8f8f2">);</span>

      <span style="color: #f8f8f2">reader.Close();</span>
      <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">result.ToString();</span>
   <span style="color: #f8f8f2">}</span>

   <span style="color: #75715e">/**</span>
<span style="color: #75715e">    * This method escapes a string in a format suitable</span>
<span style="color: #75715e">    * for JSON and JavaScript.</span>
<span style="color: #75715e">    * @author Adam Presley</span>
<span style="color: #75715e">    * @param data - The piece of data to JavaScript encode</span>
<span style="color: #75715e">    * @returns A string properly encoded for JavaScript</span>
<span style="color: #75715e">    */</span>
   <span style="color: #66d9ef">private</span> <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">string</span> <span style="color: #a6e22e">__jsonEscape</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">data)</span> <span style="color: #f8f8f2">{</span>
      <span style="color: #66d9ef">string</span> <span style="color: #f8f8f2">result</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">data;</span>

      <span style="color: #f8f8f2">result</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">result.Replace(</span><span style="color: #e6db74">&quot;\&quot;&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;\\\&quot;&quot;</span><span style="color: #f8f8f2">);</span>

      <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">result;</span>
   <span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</p>

<p>Now we can run a query or proc something like this to see JSON data.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">DECLARE</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">resultSetXML</span> <span style="color: #f8f8f2">VARCHAR(</span><span style="color: #66d9ef">max</span><span style="color: #f8f8f2">);</span>
<span style="color: #66d9ef">DECLARE</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">rootNodeName</span> <span style="color: #f8f8f2">VARCHAR(</span><span style="color: #ae81ff">75</span><span style="color: #f8f8f2">);</span>
<span style="color: #66d9ef">DECLARE</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">elementNodeName</span> <span style="color: #f8f8f2">VARCHAR(</span><span style="color: #ae81ff">75</span><span style="color: #f8f8f2">);</span>
<span style="color: #66d9ef">DECLARE</span> <span style="color: #f92672">@</span><span style="color: #66d9ef">result</span> <span style="color: #f8f8f2">VARCHAR(</span><span style="color: #66d9ef">max</span><span style="color: #f8f8f2">);</span>

<span style="color: #66d9ef">SET</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">rootNodeName</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;addresses&#39;</span><span style="color: #f8f8f2">;</span>
<span style="color: #66d9ef">SET</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">elementNodeName</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;address&#39;</span><span style="color: #f8f8f2">;</span>

<span style="color: #66d9ef">SET</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">resultSetXML</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span>
   <span style="color: #66d9ef">SELECT</span>
      <span style="color: #f8f8f2">id</span>
      <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">firstName</span>
      <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">lastName</span>
      <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">email</span>
      <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">phone</span>
      <span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">postalCode</span>
   <span style="color: #66d9ef">FROM</span> <span style="color: #f8f8f2">address</span>
   <span style="color: #66d9ef">ORDER</span> <span style="color: #66d9ef">BY</span>
      <span style="color: #f8f8f2">firstName,</span> <span style="color: #f8f8f2">lastName</span>
   <span style="color: #66d9ef">FOR</span> <span style="color: #f8f8f2">XML</span> <span style="color: #f8f8f2">AUTO,</span> <span style="color: #f8f8f2">ROOT(</span><span style="color: #e6db74">&#39;addresses&#39;</span><span style="color: #f8f8f2">));</span>

<span style="color: #66d9ef">SELECT</span> <span style="color: #f8f8f2">dbo.SQLJsonEncode(</span><span style="color: #f92672">@</span><span style="color: #f8f8f2">resultSetXML,</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">rootNodeName,</span> <span style="color: #f92672">@</span><span style="color: #f8f8f2">elementNodeName)</span> <span style="color: #66d9ef">AS</span> <span style="color: #f8f8f2">jsonResult;</span>
</pre></div>
</p>

<p>Pretty cool! Happy coding!</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fexperimenting-with-sql-to-json-in-sql-server-2008%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Experimenting%20with%20SQL%20to%20JSON%20in%20SQL%20Server%202008&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fexperimenting-with-sql-to-json-in-sql-server-2008%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fexperimenting-with-sql-to-json-in-sql-server-2008%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fexperimenting-with-sql-to-json-in-sql-server-2008%2f&title=Experimenting%20with%20SQL%20to%20JSON%20in%20SQL%20Server%202008" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/experimenting-with-sql-to-json-in-sql-server-2008\/';
    var disqus_title = 'Experimenting with SQL to JSON in SQL Server 2008';
    var disqus_url = 'http:\/\/adampresley.com\/post\/experimenting-with-sql-to-json-in-sql-server-2008\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

