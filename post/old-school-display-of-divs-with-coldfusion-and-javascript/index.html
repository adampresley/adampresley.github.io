<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Adam.Blog()</title>
        <meta name="author">
        <meta name="description" content="I&#39;m bringin&#39; nerdy back">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="generator" content="Hugo 0.16-DEV" />
          <link href="http://adampresley.com/post/index.xml" rel="alternate" type="application/rss+xml" title="Adam.Blog()" />
          <link href="http://adampresley.com/post/index.xml" rel="feed" type="application/rss+xml" title="Adam.Blog()" />
        <link href='//fonts.googleapis.com/css?family=Roboto:400,300,700|Noto+Serif:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://adampresley.com/css/styles.css">
        <link rel="icon" href="http://adampresley.com/favicon.ico">
        <link rel="apple-touch-icon" href="http://adampresley.com/apple-touch-icon.png" />
        <link rel="stylesheet" href="http://adampresley.com/css/highlightjs/monokai.css">
        <script src="http://adampresley.com/js/vendor/modernizr-2.8.0.min.js"></script>
        <style>
        .site-header h2 .logo {
        background: url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat 0 0;
        }
        @media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6 / 2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) {
          .site-header h2 .logo {
            background-image: url(http://adampresley.com/assets/images/code-background-screenshot.png);
        }}
       .site-header {
         background: #2a373d url(http://adampresley.com/assets/images/code-background-screenshot.png) no-repeat center center;
         z-index: -1;
        }
        </style>
    </head>
    <body>
        
        <header class="site-header">
          <div class="transparent-layer">
              <h2>Adam.Blog()</h2>
          </div>
        </header>


<div class="container clearfix">
    <main role="main" class="content">
        <article class="post">
            <a class="btn home" href="http://adampresley.com/" title="">&laquo; </a>
            
<h1><a href="http://adampresley.com/post/old-school-display-of-divs-with-coldfusion-and-javascript/" title="Old-School Display of DIVs with ColdFusion and Javascript">Old-School Display of DIVs with ColdFusion and Javascript</a></h1>

<footer class="post-info"> <span class="post-meta"><time datetime="2008.12.08">2008.12.08</time>

    &middot; 
        
        <a href="http://adampresley.com/tags/development">development</a>, 
        
        <a href="http://adampresley.com/tags/coldfusion">coldfusion</a>, 
        
        <a href="http://adampresley.com/tags/javascript">javascript</a>
        
    

</span>
</footer>

            <p>Today I was asked for some Javascript that would show or hide a DIV when
selecting one or more values from a multi-select box based on if the
selected values existed in a mapping table. So in this scenario there is
one query that pulls back all possible values, and a second query that
pulls back any of those records that have been mapped to another piece
of data. When the selection occurs they wanted to only show the DIV if
the selected items had been mapped.</p>

<p>Please note that the code I am showing here is not necessarily my
preferred method for doing this kind of thing, as usually I would have
the results of the mapped data come back in JSON from an AJAX call.
Since this is in a legacy application, however, we will be doing this
the old-hacky way.</p>

<ol>
<li>Get our two pieces of data. The first is a dataset of all the
elements we want to display and select from. The second is only
those elements that are mapped.</li>
<li>Present a multi-select box which an &ldquo;onchange&rdquo; handler pointing to a
Javascript function. For fun we&rsquo;ll call that function
&ldquo;showHideMyDivy&rdquo;, cause we are going to name the DIV &ldquo;myDivy&rdquo;.</li>
<li>Create a DIV called &ldquo;myDivy&rdquo; and set the display style to &ldquo;none&rdquo;.</li>
<li>Add a function to the Array object prototype called &ldquo;indexOf&rdquo;. Why?
Because Firefox may have one of these functions, but IE does not. We
need it to get the index of the array item that has the selected
value from the select box.</li>
<li>Create a global variable in Javascript called &ldquo;mappedElements&rdquo;. This
will be a Javascript array representation of the elementIds that
come back from our second query.</li>
<li>Create our &ldquo;showHideMyDivy&rdquo; function to check all selected items to
see if they are in the &ldquo;mappedElements&rdquo; array. If any one of the
selected items is in the array, show the DIV, otherwise hide it.</li>
</ol>

<p>And that&rsquo;s the gist. Here&rsquo;s the code.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">cfquery</span> <span style="color: #a6e22e">name</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;qryElements&quot;</span> <span style="color: #a6e22e">datasource</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#application.dsn#&quot;</span><span style="color: #f8f8f2">&gt;</span>
    SELECT elementId, elementName FROM elements
<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">cfquery</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">cfquery</span> <span style="color: #a6e22e">name</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;qryMappedElements&quot;</span> <span style="color: #a6e22e">datasource</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#application.dsn#&quot;</span><span style="color: #f8f8f2">&gt;</span>
    SELECT elementId FROM elements WHERE mappedId IS NOT NULL
<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">cfquery</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">html</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">head</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">script</span> <span style="color: #a6e22e">language</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;javascript&quot;</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">mappedElements</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span>
        <span style="color: #f8f8f2">&lt;cfoutput query=&quot;qryMappedElements&quot;&gt;#qryMappedElements.elementId#&lt;cfif</span> <span style="color: #f8f8f2">qryMappedElements.currentRow</span> <span style="color: #f92672">LT</span> <span style="color: #f8f8f2">qryMappedElements.recordCount&gt;,&lt;/cfif&gt;&lt;/cfoutput&gt;</span>
    <span style="color: #f8f8f2">];</span>

    <span style="color: #75715e">// This prototype is provided by the Mozilla foundation and</span>
    <span style="color: #75715e">// is distributed under the MIT license.</span>
    <span style="color: #75715e">// http://www.ibiblio.org/pub/Linux/LICENSES/mit.license</span>
    <span style="color: #75715e">// This is to support IE</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #f92672">!</span><span style="color: #f8f8f2">Array.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">Array.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">indexOf</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">elt</span> <span style="color: #75715e">/*, from*/</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">len</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span>

            <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">from</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Number(</span><span style="color: #a6e22e">arguments</span><span style="color: #f8f8f2">[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span> <span style="color: #f92672">||</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
            <span style="color: #a6e22e">from</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">from</span> <span style="color: #f92672">&lt;</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">?</span> <span style="color: #f8f8f2">Math.</span><span style="color: #a6e22e">ceil</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">from</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">:</span> <span style="color: #f8f8f2">Math.</span><span style="color: #a6e22e">floor</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">from</span><span style="color: #f8f8f2">);</span>
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">from</span> <span style="color: #f92672">&lt;</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
                <span style="color: #a6e22e">from</span> <span style="color: #f92672">+=</span> <span style="color: #a6e22e">len</span><span style="color: #f8f8f2">;</span>
            <span style="color: #f8f8f2">}</span>

            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">(;</span> <span style="color: #a6e22e">from</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">len</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">from</span><span style="color: #f92672">++</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
                <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">from</span> <span style="color: #66d9ef">in</span> <span style="color: #66d9ef">this</span> <span style="color: #f92672">&amp;&amp;</span> <span style="color: #66d9ef">this</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">from</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">elt</span><span style="color: #f8f8f2">)</span> <span style="color: #66d9ef">return</span> <span style="color: #a6e22e">from</span><span style="color: #f8f8f2">;</span>
            <span style="color: #f8f8f2">}</span>

            <span style="color: #66d9ef">return</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>
        <span style="color: #f8f8f2">};</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #66d9ef">function</span> <span style="color: #a6e22e">showHideMyDivy</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">selectedIndex</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span> <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">displayFlag</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">false</span><span style="color: #f8f8f2">;</span>
        <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">myDivyEl</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">document.</span><span style="color: #a6e22e">getElementById</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;myDivy&#39;</span><span style="color: #f8f8f2">);</span>
        <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">index</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>

        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">index</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">index</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">options</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">index</span><span style="color: #f92672">++</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">option</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">options</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">index</span><span style="color: #f8f8f2">];</span>

            <span style="color: #a6e22e">selectedIndex</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">option</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">selected</span> <span style="color: #f92672">&amp;&amp;</span> <span style="color: #a6e22e">mappedElements</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">(Number(</span><span style="color: #a6e22e">option</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">value</span><span style="color: #f8f8f2">)))</span> <span style="color: #f92672">?</span> <span style="color: #a6e22e">mappedElements</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">(Number(</span><span style="color: #a6e22e">option</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">value</span><span style="color: #f8f8f2">))</span> <span style="color: #f92672">:</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">selectedIndex</span> <span style="color: #f92672">&gt;</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
                <span style="color: #a6e22e">displayFlag</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>
                <span style="color: #66d9ef">break</span><span style="color: #f8f8f2">;</span>
            <span style="color: #f8f8f2">}</span>
        <span style="color: #f8f8f2">}</span>

        <span style="color: #a6e22e">myDivyEl</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">style</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">display</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">displayFlag</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">?</span> <span style="color: #e6db74">&#39;block&#39;</span> <span style="color: #f92672">:</span> <span style="color: #e6db74">&#39;none&#39;</span><span style="color: #f8f8f2">;</span>
    <span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">script</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">head</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">body</span><span style="color: #f8f8f2">&gt;</span>
    <span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">select</span> <span style="color: #a6e22e">name</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;selecty&quot;</span> <span style="color: #a6e22e">id</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;selecty&quot;</span> <span style="color: #a6e22e">onchange</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;showHideMyDivy(this);&quot;</span> <span style="color: #a6e22e">multiple</span><span style="color: #f8f8f2">&gt;</span>
        <span style="color: #f8f8f2">&lt;cfoutput query=&quot;qryElements&quot;&gt;</span>
            <span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">option</span> <span style="color: #a6e22e">value</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;#qryElements.elementId#&quot;</span><span style="color: #f8f8f2">&gt;#qryElements.elementName#&lt;/</span><span style="color: #f92672">option</span><span style="color: #f8f8f2">&gt;</span>
        <span style="color: #f8f8f2">&lt;/cfoutput&gt;</span>
    <span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">select</span><span style="color: #f8f8f2">&gt;</span>

    <span style="color: #f8f8f2">&lt;</span><span style="color: #f92672">div</span> <span style="color: #a6e22e">id</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;myDivy&quot;</span> <span style="color: #a6e22e">style</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;display: none;&quot;</span><span style="color: #f8f8f2">&gt;</span>A cool div<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">div</span><span style="color: #f8f8f2">&gt;</span>

<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">body</span><span style="color: #f8f8f2">&gt;</span>
<span style="color: #f8f8f2">&lt;/</span><span style="color: #f92672">html</span><span style="color: #f8f8f2">&gt;</span>
</pre></div>


<p>No, it&rsquo;s not super-sexy AJAX, but it does get the job done, and
sometimes, when working with legacy applications, that&rsquo;s just the way it
has to be. How would I have done this normally? I would&rsquo;ve created a
server-side page to execute the query against the selected elements, and
returned a JSON object indicating if any of the values were mapped,
hiding or showing the DIV appropriately.</p>

            <ul class="share-buttons">
    <li></li>
    <li>
        <a class="icon-facebook-squared" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fadampresley.com%2fpost%2fold-school-display-of-divs-with-coldfusion-and-javascript%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-twitter" href="https://twitter.com/share?text=Old-School%20Display%20of%20DIVs%20with%20ColdFusion%20and%20Javascript&amp;url=http%3a%2f%2fadampresley.com%2fpost%2fold-school-display-of-divs-with-coldfusion-and-javascript%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-gplus" href="https://plus.google.com/share?url=http%3a%2f%2fadampresley.com%2fpost%2fold-school-display-of-divs-with-coldfusion-and-javascript%2f" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title=""></a>
    </li>
    <li>
        <a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fadampresley.com%2fpost%2fold-school-display-of-divs-with-coldfusion-and-javascript%2f&title=Old-School%20Display%20of%20DIVs%20with%20ColdFusion%20and%20Javascript" onclick="window.open(this.href, 'linkedin-share', 'width=600,height=494');return false;" title=""></a>
    </li>
</ul>

        </article>
        <div class="comments">
            <h3></h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'adampresleyblog';
    var disqus_identifier = 'http:\/\/adampresley.com\/post\/old-school-display-of-divs-with-coldfusion-and-javascript\/';
    var disqus_title = 'Old-School Display of DIVs with ColdFusion and Javascript';
    var disqus_url = 'http:\/\/adampresley.com\/post\/old-school-display-of-divs-with-coldfusion-and-javascript\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </main>
    <aside class="author">
  <img class="profile-image" src="http://adampresley.com/assets/adampresley/images/adam-bowtie.png" alt="Adam Presley" />
  <p class="name"> 
  <strong>Adam Presley</strong></p>
  <p class="address">Texas, USA</p>
  <p class="link"></p>
  <ul class="social">
    
<li><a href="//twitter.com/adampresley" class="icon-twitter" target="_blank" title="Twitter"></a></li>













<li><a href="//github.com/adampresley" class="icon-github" target="_blank" title="Github"></a></li>




<li><a href="http://adampresley.com/post/index.xml" class="icon-rss" target="_blank" title="RSS"></a></li>

  </ul>
  <br><br>
</aside>

</div>

<footer class="main-footer">
  <div class="container clearfix">
        <a class="icon-rss" href="http://adampresley.com/post/index.xml" title="RSS"></a>
        <p>&copy; 2016 &middot; Adam Presley. All Rights Reserved. Powered by <a href="http://gohugo.io">Hugo</a>.</p>
  </div>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>window.jQuery || document.write('<script src="http:\/\/adampresley.com\/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
<script src="http://adampresley.com/js/plugins.js"></script>

<!-- Google Analytics -->
<script>
  var _gaq=[['_setAccount','UA-44927419-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

